# 3주차 복습

## ORM (Object-Relational Mapping)

- 애플리케이션 클래스와 관계형 데이터베이스(RDB; Relational Database)의 테이블을 매핑(연결)한다는 뜻
- 즉, 기술적으로는 애플리케이션의 객체를 RDB 테이블에 자동으로 영속화 하는 것

### ORM 장점

- SQL 문이 아닌 메서드를 통한 DB 조작이 가능. 따라서 개발자는 객체 모델을 이용해 비즈니스 로직을 구성하는 데에만 집중할 수 있음
  (내부적으로는 쿼리를 생성해 DB를 조작한다. 다만 개발자가 이를 신경쓰지 않아도 될 뿐)
- 쿼리와 같이 필요한 선언문, 할당 등의 부수적인 코드가 줄어들기 때문에, 각종 객체에 대한 코드를 별도로 작성해 코드의 가독성을 높임
- 객체지향적인 코드 작성이 가능
- 매핑하는 정보가 클래스로 명시되어있기 떄문에 ERD를 보는 의존도를 낮출 수 있고, 유지보수 및 리팩터링에 유리함
  - 예) 기존 MySQL 데이터베이스 -> PostgreSQL로 변환하는 경우, ORM을 사용하면 새로 쿼리를 작성하거나 수정할 필요가 없음

### ORM 단점

- 프로젝트의 규모가 크고 복잡해 설계가 잘못된 경우에 속도 저하 및 일관성을 무너뜨리는 문제점 발생 가능
- 복잡하고 무거운 쿼리는 속도를 위해 별도의 튜닝이 필요하기 떄문에, 결국 SQL문을 써야하는 경우도 존재

<br />
<hr />

## JPA (Java Persistence API)

- 데이터베이스에서 읽어온 데이터를 자바 객체로 매핑하는 자바의 표준 기술 (ORM)

- Java 진영에서 ORM(Object-Relational Mapping) 기술 표준으로 사용하는 인터페이스 모음
- 자바 어플리케이션에서 관계형 데이터베이스를 사용하는 방식을 정의한 인터페이스
- 인터페이스 이기 때문에 Hibernate, OpenJPA 등이 JPA를 구현함

### JPA를 사용하는 이유

- JPA는 반복적인 CRUD SQL을 처리해줌
- JPA는 매핑된 관계를 이용해 SQL을 생성하고 실행하기 때문에, 개발자는 어떤 SQL이 실행될 지 생각하기만 하면 됨
- SQL이 아닌 객체 중심의 개발이 가능해짐. 이에 따라 생산성이 좋아지고 유지보수에도 용이

### Entity

- 엔티티는 잦바와 데이터베이스가 소통하는 단위
- 테이블의 데이터 하나(레코드)는 엔티티 객체 하나로 매핑됨
- 엔티티는 간단하게 JPA가 관리하는 클래스 정도로 인식하면 된다

<br />
<hr />

## JPA Entity 매핑

### 대표적인 어노테이션

```
객체와 테이블 매핑 : @Entity, @Table
기본 키 매핑 : @Id
필드와 컬럼 매핑 : @Column
연관관계 매핑 : @ManyToOne, @JoinColumn
```

### 1. `@Entity`

- 테이블과 매핑할 클래스에는 `@Entity` 어노테이션이 반드시 명시되어야 함

- JPA에서 사용할 엔티티 이름을 지정하고, 기본값으로 클래스명을 사용
- 만약 다른 패키지에 동일한 클래스 이름이 있다면 직접 지정하여 충돌을 방지해야 함

  - 예)
    `@Entity(name="테이블 명")`

- **public이나 protected 접근 지정자인 기본 생성자가 필수**
- **final 클래스, enum, interface, inner 클래스에는 사용 불가**

### 2. `@Table`

- 엔티티와 매핑할 테이블을 지정하기 위해서 필요한 어노테이션
- 해당 어노테이션을 지정하지 않는다면, 엔티티명을 테이블명으로 사용

### 3. 기본 키(PK) 매핑

JPA의 DB 기본 키 생성 방식으로는

1. 직접 할당 : 기본 키를 애플리케이션에서 직접 할당
2. 자동 생성 : 대리 키 사용 방식
   1. IDENTITY : PK 생성을 데이터베이스에 위임 (DB에 의존)
   2. SEQUENCE : DB 시퀀스를 사용해 기본 키 할당 ( DB에 의존)
   3. TABLE : 키 생성 테이블을 만들어 사용 (DB에 의존 X)

- 기본 키 할당 시 `@ID`를 사용
- 자동 생성 전략을 사용하려면 `@GeneratedValue`를 추가하면 된다
